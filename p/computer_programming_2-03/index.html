<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="File C 將每個檔案視為一個連續的 bytes stream 每個檔案以 end-of-file 為結尾，這是由系統提供而不是文件。 It looks like there is an additional byte appended to the file. However, that additional byte does not exist. Instead, it is a signal raised by your system. int feof(FILE *stream); File Stream Streams 提供了更高級別的介面(interface)讓你存取資料。 fprintf fscanf 事實上，你已經使用過 file stream ! 三種標準流 標準輸入 0 (standard input.) 標準輸出 1 (standard output.) 標準錯誤 2 (standard error.) 真的嗎? 哪時候呀? scanf -> scanf() 從標準輸入流中讀取輸入 scanf 的實作 1 2 3 4 5 6 7 8 int scanf(const char *fmt, ...){ int count; va_list ap; va_start(ap, fmt); count = vfscanf(stdin, fmt, ap); va_end(ap); return(count); } File Descriptor File descriptor 為輸出入的操作提供了原始的低級介面(interface)。 在 Linux 中，任何東西都可以被視為一個檔案。 Network socker Device driver Inter-process communication 支援哪些操作? open、read、write、close 如果要控制某些詳細的設定，你需要使用 file descriptor 而不是 file stream。 File Stream vs. File Descriptor Structure: Stream: FILE * Descriptor: int 可以用 file stream 實現的，就一定可以用 file descriptor 實現，其逆不真。 File streams 有更多方便的介面(interface)給你使用。 I/O Redirection stdout "><title>程式設計(二)-03：File Processing-01</title>
<link rel=canonical href=https://blog.smallten.me/p/computer_programming_2-03/><link rel=stylesheet href=/scss/style.min.14c8dd7a5184c7bde0c496d7bd72d867c041f2ea72f238426b3c03c02cceecfd.css><meta property='og:title' content="程式設計(二)-03：File Processing-01"><meta property='og:description' content="File C 將每個檔案視為一個連續的 bytes stream 每個檔案以 end-of-file 為結尾，這是由系統提供而不是文件。 It looks like there is an additional byte appended to the file. However, that additional byte does not exist. Instead, it is a signal raised by your system. int feof(FILE *stream); File Stream Streams 提供了更高級別的介面(interface)讓你存取資料。 fprintf fscanf 事實上，你已經使用過 file stream ! 三種標準流 標準輸入 0 (standard input.) 標準輸出 1 (standard output.) 標準錯誤 2 (standard error.) 真的嗎? 哪時候呀? scanf -> scanf() 從標準輸入流中讀取輸入 scanf 的實作 1 2 3 4 5 6 7 8 int scanf(const char *fmt, ...){ int count; va_list ap; va_start(ap, fmt); count = vfscanf(stdin, fmt, ap); va_end(ap); return(count); } File Descriptor File descriptor 為輸出入的操作提供了原始的低級介面(interface)。 在 Linux 中，任何東西都可以被視為一個檔案。 Network socker Device driver Inter-process communication 支援哪些操作? open、read、write、close 如果要控制某些詳細的設定，你需要使用 file descriptor 而不是 file stream。 File Stream vs. File Descriptor Structure: Stream: FILE * Descriptor: int 可以用 file stream 實現的，就一定可以用 file descriptor 實現，其逆不真。 File streams 有更多方便的介面(interface)給你使用。 I/O Redirection stdout "><meta property='og:url' content='https://blog.smallten.me/p/computer_programming_2-03/'><meta property='og:site_name' content='小十的部落格'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='C'><meta property='article:tag' content='Note'><meta property='article:published_time' content='2021-04-02T17:58:22+08:00'><meta property='article:modified_time' content='2021-04-02T17:58:22+08:00'><meta name=twitter:title content="程式設計(二)-03：File Processing-01"><meta name=twitter:description content="File C 將每個檔案視為一個連續的 bytes stream 每個檔案以 end-of-file 為結尾，這是由系統提供而不是文件。 It looks like there is an additional byte appended to the file. However, that additional byte does not exist. Instead, it is a signal raised by your system. int feof(FILE *stream); File Stream Streams 提供了更高級別的介面(interface)讓你存取資料。 fprintf fscanf 事實上，你已經使用過 file stream ! 三種標準流 標準輸入 0 (standard input.) 標準輸出 1 (standard output.) 標準錯誤 2 (standard error.) 真的嗎? 哪時候呀? scanf -> scanf() 從標準輸入流中讀取輸入 scanf 的實作 1 2 3 4 5 6 7 8 int scanf(const char *fmt, ...){ int count; va_list ap; va_start(ap, fmt); count = vfscanf(stdin, fmt, ap); va_end(ap); return(count); } File Descriptor File descriptor 為輸出入的操作提供了原始的低級介面(interface)。 在 Linux 中，任何東西都可以被視為一個檔案。 Network socker Device driver Inter-process communication 支援哪些操作? open、read、write、close 如果要控制某些詳細的設定，你需要使用 file descriptor 而不是 file stream。 File Stream vs. File Descriptor Structure: Stream: FILE * Descriptor: int 可以用 file stream 實現的，就一定可以用 file descriptor 實現，其逆不真。 File streams 有更多方便的介面(interface)給你使用。 I/O Redirection stdout "><link rel="shortcut icon" href=/image/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-9L51K4B2CR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9L51K4B2CR")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu11372239997511506855.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>小十的部落格</a></h1><h2 class=site-description>教學、資訊分享、生活記趣</h2></div></header><ol class=menu-social><li><a href=https://github.com/Adam7066 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#file>File</a><ul><li><a href=#file-stream>File Stream</a></li><li><a href=#file-descriptor>File Descriptor</a><ul><li><a href=#file-stream-vs-file-descriptor>File Stream vs. File Descriptor</a></li></ul></li><li><a href=#io-redirection>I/O Redirection</a><ul><li><a href=#stdout>stdout</a></li><li><a href=#stdin>stdin</a></li></ul></li></ul></li><li><a href=#text-file-processing>Text File Processing</a><ul><li><ul><li><a href=#fopen>fopen</a></li><li><a href=#fprintf>fprintf</a></li><li><a href=#end-of-file-indicator>End-of-File Indicator</a></li><li><a href=#fclose>fclose</a></li><li><a href=#fscanf>fscanf</a></li></ul></li><li><a href=#file-position-pointer>File Position Pointer</a><ul><li><a href=#rewind>rewind</a></li><li><a href=#fseek>fseek</a></li><li><a href=#ftell>ftell</a></li></ul></li></ul></li><li><a href=#binary-file-processing>Binary File Processing</a><ul><li><a href=#binary-file>Binary File</a><ul><li><a href=#fread>fread</a></li><li><a href=#fwrite>fwrite</a></li></ul></li><li><a href=#bmp-file-format>BMP File Format</a><ul><li><a href=#讀取-bmp-檔>讀取 bmp 檔</a></li><li><a href=#修改-bmp-檔>修改 bmp 檔</a></li></ul></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E4%BA%8C/>程式設計(二)</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/computer_programming_2-03/>程式設計(二)-03：File Processing-01</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 02, 2021</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h1 id=file><a href=#file class=header-anchor></a>File</h1><ul><li>C 將每個檔案視為一個連續的 bytes stream</li><li>每個檔案以 <code>end-of-file</code> 為結尾，這是由系統提供而不是文件。
<img src=/p/computer_programming_2-03/computer_programming_2-03-01.jpg width=812 height=100 srcset="/p/computer_programming_2-03/computer_programming_2-03-01_hu7527752010453324051.jpg 480w, /p/computer_programming_2-03/computer_programming_2-03-01_hu5946345389551410217.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=812 data-flex-basis=1948px></li><li>It looks like there is an additional byte appended to the file. However, that additional byte does not exist. Instead, it is a signal raised by your system.</li><li><code>int feof(FILE *stream);</code></li></ul><h2 id=file-stream><a href=#file-stream class=header-anchor></a>File Stream</h2><ul><li>Streams 提供了更高級別的介面(interface)讓你存取資料。<ul><li><code>fprintf</code></li><li><code>fscanf</code></li></ul></li><li>事實上，你已經使用過 file stream !<ul><li>三種標準流<ol><li>標準輸入 0 (standard input.)</li><li>標準輸出 1 (standard output.)</li><li>標準錯誤 2 (standard error.)</li></ol></li><li>真的嗎? 哪時候呀?</li><li><code>scanf</code> -> scanf() 從標準輸入流中讀取輸入</li><li><code>scanf</code> 的實作<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=nf>scanf</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>fmt</span><span class=p>,</span> <span class=p>...){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>va_list</span> <span class=n>ap</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>va_start</span><span class=p>(</span><span class=n>ap</span><span class=p>,</span> <span class=n>fmt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span> <span class=o>=</span> <span class=nf>vfscanf</span><span class=p>(</span><span class=n>stdin</span><span class=p>,</span> <span class=n>fmt</span><span class=p>,</span> <span class=n>ap</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>va_end</span><span class=p>(</span><span class=n>ap</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>(</span><span class=n>count</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ul><h2 id=file-descriptor><a href=#file-descriptor class=header-anchor></a>File Descriptor</h2><ul><li>File descriptor 為輸出入的操作提供了原始的低級介面(interface)。</li><li>在 Linux 中，任何東西都可以被視為一個檔案。<ul><li>Network socker</li><li>Device driver</li><li>Inter-process communication</li></ul></li><li>支援哪些操作?<ul><li><code>open</code>、<code>read</code>、<code>write</code>、<code>close</code></li></ul></li><li>如果要控制某些詳細的設定，你需要使用 file descriptor 而不是 file stream。</li></ul><h3 id=file-stream-vs-file-descriptor><a href=#file-stream-vs-file-descriptor class=header-anchor></a>File Stream vs. File Descriptor</h3><ul><li>Structure:<ul><li>Stream: <code>FILE *</code></li><li>Descriptor: <code>int</code></li></ul></li><li>可以用 file stream 實現的，就一定可以用 file descriptor 實現，其逆不真。</li><li>File streams 有更多方便的介面(interface)給你使用。</li></ul><h2 id=io-redirection><a href=#io-redirection class=header-anchor></a>I/O Redirection</h2><h3 id=stdout><a href=#stdout class=header-anchor></a>stdout</h3><p><img src=/p/computer_programming_2-03/computer_programming_2-03-02.jpg width=890 height=552 srcset="/p/computer_programming_2-03/computer_programming_2-03-02_hu481598910743009187.jpg 480w, /p/computer_programming_2-03/computer_programming_2-03-02_hu13114987398873744076.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=161 data-flex-basis=386px></p><ul><li><code>></code> filename<ul><li>重導向 stdout 到一個檔案</li><li>如果檔案不存在就創建文件，否則就將其覆蓋</li></ul></li><li><code>>></code> filename<ul><li>重導向 stdout 到一個檔案</li><li>如果檔案不存在就創建文件，否則就加在後方</li></ul></li></ul><hr><ul><li><code>></code> filename</li><li><code>1></code> filename<ul><li>Redirect stdout to file &ldquo;filename&rdquo;</li></ul></li><li><code>>></code> filename</li><li><code>1>></code> filename<ul><li>Redirect and append stdout to file &ldquo;filename&rdquo;</li></ul></li><li><code>2></code> filename<ul><li>Redirect stderr to file ”filename.”</li></ul></li><li><code>2>></code> filename<ul><li>Redirect and append stderr to file ”filename.”</li></ul></li><li><code>&></code> filename<ul><li>Redirect stdout, stderr to file ”filename.”</li></ul></li></ul><h3 id=stdin><a href=#stdin class=header-anchor></a>stdin</h3><p><code>$ . / abs &lt; number.txt</code></p><h1 id=text-file-processing><a href=#text-file-processing class=header-anchor></a>Text File Processing</h1><h3 id=fopen><a href=#fopen class=header-anchor></a>fopen</h3><p><code>FILE *fopen(const char *path, const char *mode);</code></p><ul><li>path：檔案路徑</li><li>mode：<ul><li><code>r</code>：read</li><li><code>w</code>：write</li><li><code>a</code>：append</li><li>更多的選項在手冊中</li></ul></li><li>Return：<code>FILE *</code><ul><li>成功的話，FILE pointer 將被回傳</li><li>如果失敗的話，將回傳 NULL 並且 errno 被設置為表明 error</li><li>永遠記得確認回傳的 pointer!</li></ul></li></ul><h3 id=fprintf><a href=#fprintf class=header-anchor></a>fprintf</h3><ul><li>幾乎和<code>printf</code>相同，除了你需要給 FILE stream pointer。</li></ul><h3 id=end-of-file-indicator><a href=#end-of-file-indicator class=header-anchor></a>End-of-File Indicator</h3><ul><li>Linu/Mac OS X/UNIX：<code>&lt;Ctrl> d</code></li><li>Windows：<code>&lt;Ctrl> z + enter</code></li></ul><h3 id=fclose><a href=#fclose class=header-anchor></a>fclose</h3><p><code>int fclose(FILE *stream);</code></p><ul><li><code>fclose()</code></li><li>The fclose() function flushes the stream pointed to by stream (writing any buffered output data using fflush(3)) and closes the underlying file descriptor.</li><li>也就是說，當你 close 時，在 buffer 中的資料將被寫入檔案</li><li>在開檔後記得關上它!! 因為有同時開檔的數量上限。</li></ul><h3 id=fscanf><a href=#fscanf class=header-anchor></a>fscanf</h3><ul><li>操作就如同 <code>fprintf</code></li><li>當然，檔案應該被以 <code>r</code> 的模式打開</li></ul><hr><ul><li>當你使用 <code>fprintf</code> 或 <code>fscanf</code> 去處理文字檔時，它蘊含著你清楚地知道檔案的格式</li><li>在這些情況下，輸入的檢查也許就沒那麼重要了，對吧?<ul><li>Yes：畢竟格式由你決定。</li><li>No：有些人可能會修改檔案，並使你讀取它。</li></ul></li></ul><h2 id=file-position-pointer><a href=#file-position-pointer class=header-anchor></a>File Position Pointer</h2><p><img src=/p/computer_programming_2-03/computer_programming_2-03-03.jpg width=784 height=487 srcset="/p/computer_programming_2-03/computer_programming_2-03-03_hu15911136391182091241.jpg 480w, /p/computer_programming_2-03/computer_programming_2-03-03_hu5253341277596996956.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=386px></p><ul><li>所以我們可以返回到開始的位置嗎??<ul><li>為什麼我們需要這麼做? -> 影片倒放</li><li>當然，你可以關掉檔案並重開它。</li><li>但我們有另外的函式可以幫助我們 -> <code>rewind</code></li></ul></li></ul><h3 id=rewind><a href=#rewind class=header-anchor></a>rewind</h3><p><code>void rewind(FILE *stream);</code></p><ul><li>將位置指回檔案的開頭。</li><li>那麼我們想要改變 file pointer 到任何地方呢? -> <code>fseek</code></li></ul><h3 id=fseek><a href=#fseek class=header-anchor></a>fseek</h3><p><code>int fseek(FILE *stream, long offset, int whence);</code></p><ul><li>The fseek() function sets the file position indicator for the stream pointed to by stream. The new position, measured in bytes, is obtained by adding offset bytes to the position specified by whence.</li><li><code>SEEK_SET</code>：檔案開頭</li><li><code>SEEK_CUR</code>：當前位置</li><li><code>SEEK_END</code>：end-of-file</li></ul><hr><ul><li><code>rewind()</code> 相當於 <code>fseek(stream, 0L, SEEK_SET)</code></li></ul><h3 id=ftell><a href=#ftell class=header-anchor></a>ftell</h3><p><code>long ftell(FILE *stream);</code></p><ul><li>告訴你當前所在的位置。</li></ul><h1 id=binary-file-processing><a href=#binary-file-processing class=header-anchor></a>Binary File Processing</h1><h2 id=binary-file><a href=#binary-file class=header-anchor></a>Binary File</h2><ul><li>文字檔以字元的方式儲存資料，然而並不是所有的檔案都是文字檔。例如，你可以用文字編輯器打開一張圖片。</li><li>此外文字檔的儲存效率並不高<ul><li>需要多少大小去儲存數字 123 ?</li><li>Text File：3 bytes</li><li>Binary File：1 byte</li></ul></li></ul><h3 id=fread><a href=#fread class=header-anchor></a>fread</h3><p><code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);</code></p><ul><li>從 FILE * 讀取 nmemb 個資料，每個 size bytes 長，並將它們儲存在 *ptr。</li><li>成功時回傳資料讀取的數量。如果失敗，或到達文件尾端時，則回傳是一短項計數 (或 0)</li></ul><h3 id=fwrite><a href=#fwrite class=header-anchor></a>fwrite</h3><p><code>size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream);</code></p><ul><li>從 *ptr 讀取 nmemb 個資料，每個 size bytes 長，並將它們儲存在 FILE *。</li><li>成功時回傳資料寫入的數量。如果失敗，或到達文件尾端時，則回傳是一短項計數 (或 0)</li></ul><h2 id=bmp-file-format><a href=#bmp-file-format class=header-anchor></a>BMP File Format</h2><ul><li>這裡將使用 bmp 檔作為示範<ul><li>為什麼是 bmp 而不是 jpg ? -> 因為 bmp 是一種未被壓縮的照片格式。</li></ul></li><li><a class=link href=https://engineering.purdue.edu/ece264/17au/hw/HW15 target=_blank rel=noopener>連結</a></li></ul><h3 id=讀取-bmp-檔><a href=#%e8%ae%80%e5%8f%96-bmp-%e6%aa%94 class=header-anchor></a>讀取 bmp 檔</h3><ul><li>讀取 bmp file header 並印出資訊</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdint.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>_sBmpHeader</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>bm</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>size</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>reserve</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>offset</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>header_size</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=n>width</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=n>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint16_t</span> <span class=n>planes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint16_t</span> <span class=n>bpp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>compression</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>bitmap_size</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=n>hres</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=n>vres</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>used</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>important</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=nf>__attribute__</span> <span class=p>((</span><span class=n>__packed__</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=k>struct</span> <span class=n>_sBmpHeader</span> <span class=n>sBmpHeader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>print_bmp_header</span><span class=p>(</span> <span class=n>sBmpHeader</span> <span class=o>*</span><span class=n>pHeader</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;ID: %c%c</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>bm</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>bm</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Size: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>size</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Reserve: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>reserve</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Offset: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>offset</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Header Size: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>header_size</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Width: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>width</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Height: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>height</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Planes: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>planes</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Bits Per Pixel: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>bpp</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Compression: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>compression</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Bitmap Data Size: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>bitmap_size</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;H-Resolution: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>hres</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;V-Resolution: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>vres</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Used Colors: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>used</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;Important Colors: %u</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>pHeader</span> <span class=o>-&gt;</span> <span class=n>important</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span> <span class=o>*</span><span class=n>pFile</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>((</span><span class=n>pFile</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;maldives_16.bmp&#34;</span><span class=p>,</span> <span class=s>&#34;rb&#34;</span><span class=p>))</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;File could not be opened!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>sBmpHeader</span> <span class=n>header</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%lu</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>header</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nf>fread</span><span class=p>(</span><span class=o>&amp;</span><span class=n>header</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>pFile</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>print_bmp_header</span><span class=p>(</span><span class=o>&amp;</span><span class=n>header</span><span class=p>);</span>                
</span></span><span class=line><span class=cl>    <span class=nf>fclose</span><span class=p>(</span><span class=n>pFile</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=修改-bmp-檔><a href=#%e4%bf%ae%e6%94%b9-bmp-%e6%aa%94 class=header-anchor></a>修改 bmp 檔</h3><ul><li>翻轉顏色</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// ...略...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span> <span class=o>*</span><span class=n>pFile</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span> <span class=o>*</span><span class=n>pFile2</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>((</span><span class=n>pFile</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;maldives.bmp&#34;</span><span class=p>,</span> <span class=s>&#34;rb&#34;</span><span class=p>))</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>printf</span><span class=p>(</span> <span class=s>&#34;File could not be opened!</span><span class=se>\n</span><span class=s>&#34;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>((</span><span class=n>pFile2</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;maldives_gray.bmp&#34;</span><span class=p>,</span> <span class=s>&#34;wb&#34;</span><span class=p>))</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;File could not be opened!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>sBmpHeader</span>	<span class=n>header</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>fread</span><span class=p>(</span> <span class=o>&amp;</span><span class=n>header</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span> <span class=n>header</span> <span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=n>pFile</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fwrite</span><span class=p>(</span> <span class=o>&amp;</span><span class=n>header</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span> <span class=n>header</span> <span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=n>pFile2</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=nf>feof</span><span class=p>(</span><span class=n>pFile</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span>	<span class=n>original</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span> <span class=n>modified</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=kt>size_t</span> <span class=n>count</span> <span class=o>=</span> <span class=nf>fread</span><span class=p>(</span> <span class=n>original</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1024</span><span class=p>,</span> <span class=n>pFile</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>count</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>modified</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>255</span> <span class=o>-</span> <span class=n>original</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>fwrite</span><span class=p>(</span> <span class=n>modified</span><span class=p>,</span> <span class=n>count</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>pFile2</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>fclose</span><span class=p>(</span> <span class=n>pFile</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fclose</span><span class=p>(</span> <span class=n>pFile2</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>轉成灰階</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// ...略...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=nf>feof</span><span class=p>(</span><span class=n>pFile</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint8_t</span>	<span class=n>original</span><span class=p>[</span><span class=mi>999</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint8_t</span> <span class=n>modified</span><span class=p>[</span><span class=mi>999</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>size_t</span> <span class=n>count</span> <span class=o>=</span> <span class=nf>fread</span><span class=p>(</span> <span class=n>original</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>999</span><span class=p>,</span> <span class=n>pFile</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>count</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// BGR
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>uint8_t</span> <span class=n>gray</span> <span class=o>=</span> <span class=mf>0.299</span> <span class=o>*</span> <span class=n>original</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.587</span> <span class=o>*</span> <span class=n>original</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.114</span> <span class=o>*</span> <span class=n>original</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>size_t</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>modified</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>gray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>fwrite</span><span class=p>(</span><span class=n>modified</span><span class=p>,</span> <span class=n>count</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>pFile2</span><span class=p>);</span>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// ...略...
</span></span></span></code></pre></td></tr></table></div></div><hr><h4 id=hex-編輯工具><a href=#hex-%e7%b7%a8%e8%bc%af%e5%b7%a5%e5%85%b7 class=header-anchor></a>Hex 編輯工具</h4><ul><li>Bless Hex Editor</li><li>GHex</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/c/>C</a>
<a href=/tags/note/>Note</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/computer_programming_2-08/><div class=article-details><h2 class=article-title>程式設計(二)-08：Linux List</h2></div></a></article><article><a href=/p/computer_programming_2-07/><div class=article-details><h2 class=article-title>程式設計(二)-07：Some Tricks</h2></div></a></article><article><a href=/p/computer_programming_2-06/><div class=article-details><h2 class=article-title>程式設計(二)-06：Macro</h2></div></a></article><article><a href=/p/computer_programming_2-05/><div class=article-details><h2 class=article-title>程式設計(二)-05：Variable Length Arguments List</h2></div></a></article><article><a href=/p/computer_programming_2-04/><div class=article-details><h2 class=article-title>程式設計(二)-04：File Processing-02</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 小十的部落格</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>