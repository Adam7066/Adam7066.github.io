<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='主題 最短路徑 最短路徑模板 Dijkstra’s 不能有負邊 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 int vn; // vertex num struct Edge { int w, idx; bool operator < (const Edge &amp;r) const { return w > r.w; } }; vector<Edge> adj[maxv]; void dijkstra(int s) { vector<bool> vis(vn, false); vector<int> dist(vn, INF); dist[s] = 0; priority_queue<Edge> pq; pq.emplace(0, s); while(!pq.empty()) { int u = pq.top().idx; pq.pop(); if(vis[u]) continue; vis[u] = true; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { dist[v.idx] = dist[u] + v.w; pq.emplace(dist[v.idx], v.idx); } } } } Bellman-Ford 可以檢查是否有環 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 int vn; // vertex num struct Edge { int idx, w; }; vector<Edge> adj[maxv]; bool bellmanford(int s) { //return true if negative cycle exists; int cnt = 0; bool update = false; vector<int> dist(vn, INF); dist[s] = 0; do { if(++cnt == vn) return true; update = false; for(int u = 0; u < vn; ++u) { if(dist[u] == INF) continue; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { update = true; dist[v.idx] = dist[u] + v.w; } } } } while(update); return false; } Floyd-Warshall 1 2 3 4 5 int dist[MAX_V][MAX_V]; for(int k = 0; k < vn; ++k) for(int i = 0; i < vn; ++i) for(int j = 0; j < vn; ++j) dist[i][j] = min(dist[i][j], dist[i][k] + dist[k][j]); 題目 Virtual Judge 題目列表與提示 題目 題目需求 難度 UVa 929 給一個二維迷宮，求左上走到右下的最少成本（最短路徑）。 單源模板題 UVa 10986 給一個無向帶權圖，求指定兩點間的最短路徑長。 單源模板題 UVa 10000 給一個有向無環圖，求指定兩點間的最長路徑。 多種作法 UVa 558 給定一個有向帶權圖（黑洞通道為邊），問是否存在負環（可回到無限遠的過去）。 BF UVa 10801 給定電梯系統與移動時間，若轉換電梯需 60 秒，問去某樓的最短時間。 單源小變化 UVa 821 給一個無向無權圖，求所有兩點間最短路徑長的平均值。 FW 模板題 UVa 10048 給一個無向帶權圖，求指定兩點間路徑上最大邊權的最小值。 FW 變化 UVa 658 給一堆修補程式的安裝前後狀態，問最少要安裝多少次修補程式可以修好所有 bug。 變化題 UVa 11374 給經濟線和商業線兩套捷運路線圖的行駛時間，在商業線只能搭一段的限制下，求指定兩點間的最快路線。 變化題 UVa 10917 題目不長，自己讀讀看。 變化題 參考作法 A - Number Maze 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using tiii = tuple<int, int, int>; int d[4][2] = {{0, 1}, {1, 0}, {0, -1}, {-1, 0}}; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { int n, m; cin >> n >> m; vector<vector<int>> g(n, vector<int>(m, 0)); vector<vector<int>> val(n, vector<int>(m, -1)); vector<vector<bool>> vis(n, vector<bool>(m, false)); priority_queue<tiii, vector<tiii>, greater<tiii>> pq; for(int i = 0; i < n; ++i) for(int j = 0; j < m; ++j) cin >> g[i][j]; val[0][0] = g[0][0]; pq.push(make_tuple(g[0][0], 0, 0)); while(!pq.empty()) { int v, x, y; tie(v, x, y) = pq.top(); pq.pop(); vis[x][y] = true; for(int i = 0; i < 4; ++i) { int nx = x + d[i][0], ny = y + d[i][1]; if(nx >= 0 && nx < n && ny >= 0 && ny < m && !vis[nx][ny]) { int tmp = v + g[nx][ny]; if(val[nx][ny] == -1 || val[nx][ny] > tmp) { val[nx][ny] = tmp; pq.push(make_tuple(tmp, nx, ny)); } } } } cout << val[n - 1][m - 1] << endl; } return 0; } B - Sending email 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using pii = pair<int, int>; using plli = pair<long long, int>; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; for(int ca = 1; ca <= T; ++ca) { cout << "Case #" << ca << ": "; int n, m, s, t; cin >> n >> m >> s >> t; vector<pii> g[n]; vector<long long> val(n, INF); vector<bool> vis(n, false); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; g[a].push_back({b, c}); g[b].push_back({a, c}); } priority_queue<plli, vector<plli>, greater<plli>> pq; val[s] = 0; pq.push({0, s}); while(!pq.empty()) { int v = pq.top().first, x = pq.top().second; pq.pop(); if(val[x] < v) continue; for(auto it : g[x]) { if(val[it.first] > val[x] + it.second) { val[it.first] = val[x] + it.second; pq.push({val[it.first], it.first}); } } } if(val[t] == INF) cout << "unreachable\\n"; else cout << val[t] << endl; } return 0; } C - Longest Paths 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 struct edge { int u, v; }; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, cnt = 0; while(cin >> n && n) { int s; cin >> s; int p, q; vector<edge> g; vector<int> val(n + 1, INF); while(cin >> p >> q && !(p == 0 && q == 0)) g.push_back({p, q}); val[s] = 0; for(int i = 0; i < n; ++i) { for(auto it : g) { if(val[it.v] > val[it.u] - 1 && val[it.u] != INF) val[it.v] = val[it.u] - 1; } } int en, ans = 0; for(int i = 1; i <= n; ++i) { if(val[i] < ans) { ans = val[i]; en = i; } } cout << "Case " << ++cnt << ": The longest path from " << s << " has length " << -1 * ans << ", finishing at " << en << ".\\n\\n"; } return 0; } D - Wormholes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int n, m; struct edge { int u, v, w; }; bool Bellman_Ford(vector<edge> &amp;ve, vector<int> val) { for(int i = 0; i < n; ++i) { bool flag = false; for(int j = 0; j < m; ++j) { if(val[ve[j].v] > val[ve[j].u] + ve[j].w && val[ve[j].u] != INF) { val[ve[j].v] = val[ve[j].u] + ve[j].w; flag = true; } } if(!flag) return true; if(i == n - 1 && flag) return false; } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { cin >> n >> m; vector<edge> ve; vector<int> val(n, INF); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; ve.push_back({a, b, c}); } val[0] = 0; if(Bellman_Ford(ve, val)) cout << "not possible\\n"; else cout << "possible\\n"; } return 0; } E - Lift Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, tar; while(cin >> n >> tar) { vector<int> vt(n), va; vector<vector<int>> w(100, vector<int>(100, INF)); for(int i = 0; i < n; ++i) cin >> vt[i]; cin.ignore(100, &#39;\\n&#39;); for(int i = 0; i < n; ++i) { va.clear(); string s; getline(cin, s); stringstream ss(s); int tmp; while(ss >> tmp) va.push_back(tmp); for(int j = 0; j < va.size(); ++j) { for(int k = j + 1; k < va.size(); ++k) { int dis = abs(va[j] - va[k]) * vt[i]; if(dis < w[va[j]][va[k]]) w[va[j]][va[k]] = w[va[k]][va[j]] = dis; } } } vector<bool> vis(n, false); vector<int> d(100, INF); d[0] = 0; for(int i = 0; i < 100; ++i) { int x, m = INF; for(int y = 0; y < 100; ++y) { if(!vis[y] && d[y] < m) { m = d[y]; x = y; } } vis[x] = true; for(int y = 0; y < 100; ++y) { if(d[y] > d[x] + w[x][y] + 60) d[y] = d[x] + w[x][y] + 60; } } if(d[tar] == INF) cout << "IMPOSSIBLE\\n"; else { if(tar == 0) cout << "0\\n"; else cout << d[tar] - 60 << endl; } } return 0; } F - Page Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 map<int, int> m; void memNum(int n) { if(m.find(n) == m.end()) m[n] = m.size(); } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1, x, y; while(cin >> x >> y && !(x == 0 && y == 0)) { m.clear(); vector<vector<int>> g(110, vector<int>(110, INF)); for(int i = 0; i < 110; ++i) g[i][i] = 0; memNum(x); memNum(y); g[m[x]][m[y]] = 1; while(cin >> x >> y && !(x == 0 && y == 0)) { memNum(x); memNum(y); g[m[x]][m[y]] = 1; } int cnt = 0, sz = m.size(); for(int k = 0; k < sz; ++k) { for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { g[i][j] = min(g[i][j], g[i][k] + g[k][j]); } } } for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { if(g[i][j] != INF) cnt += g[i][j]; } } cout << "Case " << ca++ << ": average length between pages = "; cout << fixed << setprecision(3) << (double)cnt / (sz * (sz - 1)) << " clicks\\n"; } return 0; } G - Audiophobia 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int c, s, q, ca = 1; while(cin >> c >> s >> q && !(c == 0 && s == 0 && q == 0)) { vector<vector<int>> path(1005, vector<int>(1005, INF)); int c1, c2, d; for(int i = 0; i < s; ++i) { cin >> c1 >> c2 >> d; path[c1][c2] = path[c2][c1] = d; } for(int k = 1; k <= c; ++k) { for(int i = 1; i <= c; ++i) { for(int j = 1; j <= c; ++j) { path[i][j] = min(path[i][j], max(path[i][k], path[k][j])); } } } if(ca > 1) cout << endl; cout << "Case #" << ca++ << endl; for(int i = 0; i < q; ++i) { cin >> c1 >> c2; if(path[c1][c2] != INF) cout << path[c1][c2] << endl; else cout << "no path\\n"; } } return 0; } H - It&rsquo;s not a Bug, it&rsquo;s a Feature! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn (1<<20) + 10 #define maxm 110 int n, m, minTime; bool vis[maxn]; struct node { int time; int a1, a2, b1, b2; } a[maxm]; struct pqNode { int u, d; bool operator < (const pqNode &amp;r) const { return d > r.d; } }; bool dijkstra() { priority_queue<pqNode> pq; pq.push({(1 << n) - 1, 0}); while(!pq.empty()) { pqNode x = pq.top(); pq.pop(); if(x.u == 0) { minTime = x.d; return true; } if(vis[x.u]) continue; vis[x.u] = true; for(int i = 0; i < m; ++i) { if((x.u & a[i].a1) == a[i].a1 && (~x.u & a[i].a2) == a[i].a2) { int t = x.u | a[i].b1; t = t & ~a[i].b2; pq.push({t, x.d + a[i].time}); } } } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1; while(cin >> n >> m && !(n == 0 && m == 0)) { cout << "Product " << ca++ << endl; memset(vis, false, sizeof(vis)); for(int i = 0; i <= m; ++i) a[i].time = a[i].a1 = a[i].a2 = a[i].b1 = a[i].b2 = 0; for(int i = 0; i < m; ++i) { int t; string s1, s2; cin >> t >> s1 >> s2; for(int j = 0; j < n; ++j) { a[i].time = t; if(s1[n - 1 - j] == &#39;+&#39;) a[i].a1 = (a[i].a1 | (1 << j)); if(s1[n - 1 - j] == &#39;-&#39;) a[i].a2 = (a[i].a2 | (1 << j)); if(s2[n - 1 - j] == &#39;+&#39;) a[i].b1 = (a[i].b1 | (1 << j)); if(s2[n - 1 - j] == &#39;-&#39;) a[i].b2 = (a[i].b2 | (1 << j)); } } if(dijkstra()) cout << "Fastest sequence takes " << minTime << " seconds.\\n"; else cout << "Bugs cannot be fixed.\\n"; cout << endl; } return 0; } I - Airport Express 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn 505 struct edge { int u, v, dist; }; struct node { int d, u; bool operator < (const node &amp;r) const { return d > r.d; } }; vector<edge> ve; vector<int> g[maxn], path1[maxn], path2[maxn]; bool done[maxn]; int d[maxn], p[maxn], d1[maxn], d2[maxn]; int ca = 0, n, s, e, m, k; void dijkstra(int s, int *dist, vector<int> *paths) { priority_queue<node> pq; for(int i = 0; i < n; ++i) d[i] = INF; d[s] = 0; memset(done, 0, sizeof(done)); pq.push({0, s}); while(!pq.empty()) { node x = pq.top(); pq.pop(); if(done[x.u]) continue; done[x.u] = true; for(int i = 0; i < g[x.u].size(); ++i) { edge &amp;e = ve[g[x.u][i]]; if(d[e.v] > d[x.u] + e.dist) { d[e.v] = d[x.u] + e.dist; p[e.v] = g[x.u][i]; pq.push({d[e.v], e.v}); } } } for(int i = 0; i < n; ++i) { dist[i] = d[i]; paths[i].clear(); int t = i; paths[i].push_back(t); while(t != s) { paths[i].push_back(ve[p[t]].u); t = ve[p[t]].u; } reverse(paths[i].begin(), paths[i].end()); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> s >> e >> m) { for(int i = 0; i < n; ++i) g[i].clear(); ve.clear(); --s; --e; for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; ve.push_back({a, b, c}); g[a].push_back(ve.size()-1); ve.push_back({b, a, c}); g[b].push_back(ve.size()-1); } dijkstra(s, d1, path1); dijkstra(e, d2, path2); int ans = d1[e]; vector<int> pp = path1[e]; int midpoint = -1; cin >> k; for(int i = 0; i < k; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; for(int j = 0; j < 2; ++j) { if(d1[a] + d2[b] + c < ans) { ans = d1[a] + d2[b] + c; pp = path1[a]; for(int p = path2[b].size() - 1; p >= 0; --p) pp.push_back(path2[b][p]); midpoint = a; } swap(a, b); } } if(ca++ != 0) cout << endl; for(int i = 0; i < pp.size() - 1; ++i) cout << pp[i] + 1 << " "; cout << e + 1 << endl; if(midpoint == -1) cout << "Ticket Not Used\\n"; else cout << midpoint + 1 << endl; cout << ans << endl; } return 0; } J - Walk Through the Forest 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 vector<pair<int, int>> link[1001]; vector<int> rebuild[1001]; int distant[1001]; int dp[1001]; bool vis[1001]; int n, m; struct node { int dis, index; bool operator < (const node &amp;r) const { return dis > r.dis; } }; int dfs(int now) { if(now == 1) return 1; if(dp[now] == -1) { dp[now] = 0; for(auto i : rebuild[now]) dp[now] += dfs(i); } return dp[now]; } void dijkstra() { priority_queue<node> pq; pq.push({0, 1}); int cur; distant[1] = 0; while(!pq.empty()) { cur = pq.top().index; pq.pop(); if(vis[cur]) continue; vis[cur] = 1; for(auto i : link[cur]) { int next = i.first; int dis = i.second; if(distant[next] > distant[cur] + dis) { distant[next] = distant[cur] + dis; pq.push({distant[next], next}); } } } } void build() { memset(dp, -1, sizeof(dp)); int next, dis; for(int i = 0; i < n; ++i) { rebuild[i].clear(); for(auto j : link[i]) if(distant[i] > distant[j.first]) rebuild[i].emplace_back(j.first); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> m && n) { memset(link, 0, sizeof(link)); memset(vis, 0, sizeof(vis)); for(int i = 0; i < n; ++i) distant[i] = INF; while(m--) { int a, b, c; cin >> a >> b >> c; link[--a].push_back({--b, c}); link[b].push_back({a, c}); } dijkstra(); build(); cout << dfs(0) << &#39;\\n&#39;; } return 0; } '><title>StarCoder2021暑訓：Week06</title>
<link rel=canonical href=https://blog.smallten.me/p/star_coder-07/><link rel=stylesheet href=/scss/style.min.14c8dd7a5184c7bde0c496d7bd72d867c041f2ea72f238426b3c03c02cceecfd.css><meta property='og:title' content="StarCoder2021暑訓：Week06"><meta property='og:description' content='主題 最短路徑 最短路徑模板 Dijkstra’s 不能有負邊 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 int vn; // vertex num struct Edge { int w, idx; bool operator < (const Edge &amp;r) const { return w > r.w; } }; vector<Edge> adj[maxv]; void dijkstra(int s) { vector<bool> vis(vn, false); vector<int> dist(vn, INF); dist[s] = 0; priority_queue<Edge> pq; pq.emplace(0, s); while(!pq.empty()) { int u = pq.top().idx; pq.pop(); if(vis[u]) continue; vis[u] = true; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { dist[v.idx] = dist[u] + v.w; pq.emplace(dist[v.idx], v.idx); } } } } Bellman-Ford 可以檢查是否有環 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 int vn; // vertex num struct Edge { int idx, w; }; vector<Edge> adj[maxv]; bool bellmanford(int s) { //return true if negative cycle exists; int cnt = 0; bool update = false; vector<int> dist(vn, INF); dist[s] = 0; do { if(++cnt == vn) return true; update = false; for(int u = 0; u < vn; ++u) { if(dist[u] == INF) continue; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { update = true; dist[v.idx] = dist[u] + v.w; } } } } while(update); return false; } Floyd-Warshall 1 2 3 4 5 int dist[MAX_V][MAX_V]; for(int k = 0; k < vn; ++k) for(int i = 0; i < vn; ++i) for(int j = 0; j < vn; ++j) dist[i][j] = min(dist[i][j], dist[i][k] + dist[k][j]); 題目 Virtual Judge 題目列表與提示 題目 題目需求 難度 UVa 929 給一個二維迷宮，求左上走到右下的最少成本（最短路徑）。 單源模板題 UVa 10986 給一個無向帶權圖，求指定兩點間的最短路徑長。 單源模板題 UVa 10000 給一個有向無環圖，求指定兩點間的最長路徑。 多種作法 UVa 558 給定一個有向帶權圖（黑洞通道為邊），問是否存在負環（可回到無限遠的過去）。 BF UVa 10801 給定電梯系統與移動時間，若轉換電梯需 60 秒，問去某樓的最短時間。 單源小變化 UVa 821 給一個無向無權圖，求所有兩點間最短路徑長的平均值。 FW 模板題 UVa 10048 給一個無向帶權圖，求指定兩點間路徑上最大邊權的最小值。 FW 變化 UVa 658 給一堆修補程式的安裝前後狀態，問最少要安裝多少次修補程式可以修好所有 bug。 變化題 UVa 11374 給經濟線和商業線兩套捷運路線圖的行駛時間，在商業線只能搭一段的限制下，求指定兩點間的最快路線。 變化題 UVa 10917 題目不長，自己讀讀看。 變化題 參考作法 A - Number Maze 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using tiii = tuple<int, int, int>; int d[4][2] = {{0, 1}, {1, 0}, {0, -1}, {-1, 0}}; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { int n, m; cin >> n >> m; vector<vector<int>> g(n, vector<int>(m, 0)); vector<vector<int>> val(n, vector<int>(m, -1)); vector<vector<bool>> vis(n, vector<bool>(m, false)); priority_queue<tiii, vector<tiii>, greater<tiii>> pq; for(int i = 0; i < n; ++i) for(int j = 0; j < m; ++j) cin >> g[i][j]; val[0][0] = g[0][0]; pq.push(make_tuple(g[0][0], 0, 0)); while(!pq.empty()) { int v, x, y; tie(v, x, y) = pq.top(); pq.pop(); vis[x][y] = true; for(int i = 0; i < 4; ++i) { int nx = x + d[i][0], ny = y + d[i][1]; if(nx >= 0 && nx < n && ny >= 0 && ny < m && !vis[nx][ny]) { int tmp = v + g[nx][ny]; if(val[nx][ny] == -1 || val[nx][ny] > tmp) { val[nx][ny] = tmp; pq.push(make_tuple(tmp, nx, ny)); } } } } cout << val[n - 1][m - 1] << endl; } return 0; } B - Sending email 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using pii = pair<int, int>; using plli = pair<long long, int>; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; for(int ca = 1; ca <= T; ++ca) { cout << "Case #" << ca << ": "; int n, m, s, t; cin >> n >> m >> s >> t; vector<pii> g[n]; vector<long long> val(n, INF); vector<bool> vis(n, false); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; g[a].push_back({b, c}); g[b].push_back({a, c}); } priority_queue<plli, vector<plli>, greater<plli>> pq; val[s] = 0; pq.push({0, s}); while(!pq.empty()) { int v = pq.top().first, x = pq.top().second; pq.pop(); if(val[x] < v) continue; for(auto it : g[x]) { if(val[it.first] > val[x] + it.second) { val[it.first] = val[x] + it.second; pq.push({val[it.first], it.first}); } } } if(val[t] == INF) cout << "unreachable\\n"; else cout << val[t] << endl; } return 0; } C - Longest Paths 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 struct edge { int u, v; }; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, cnt = 0; while(cin >> n && n) { int s; cin >> s; int p, q; vector<edge> g; vector<int> val(n + 1, INF); while(cin >> p >> q && !(p == 0 && q == 0)) g.push_back({p, q}); val[s] = 0; for(int i = 0; i < n; ++i) { for(auto it : g) { if(val[it.v] > val[it.u] - 1 && val[it.u] != INF) val[it.v] = val[it.u] - 1; } } int en, ans = 0; for(int i = 1; i <= n; ++i) { if(val[i] < ans) { ans = val[i]; en = i; } } cout << "Case " << ++cnt << ": The longest path from " << s << " has length " << -1 * ans << ", finishing at " << en << ".\\n\\n"; } return 0; } D - Wormholes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int n, m; struct edge { int u, v, w; }; bool Bellman_Ford(vector<edge> &amp;ve, vector<int> val) { for(int i = 0; i < n; ++i) { bool flag = false; for(int j = 0; j < m; ++j) { if(val[ve[j].v] > val[ve[j].u] + ve[j].w && val[ve[j].u] != INF) { val[ve[j].v] = val[ve[j].u] + ve[j].w; flag = true; } } if(!flag) return true; if(i == n - 1 && flag) return false; } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { cin >> n >> m; vector<edge> ve; vector<int> val(n, INF); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; ve.push_back({a, b, c}); } val[0] = 0; if(Bellman_Ford(ve, val)) cout << "not possible\\n"; else cout << "possible\\n"; } return 0; } E - Lift Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, tar; while(cin >> n >> tar) { vector<int> vt(n), va; vector<vector<int>> w(100, vector<int>(100, INF)); for(int i = 0; i < n; ++i) cin >> vt[i]; cin.ignore(100, &#39;\\n&#39;); for(int i = 0; i < n; ++i) { va.clear(); string s; getline(cin, s); stringstream ss(s); int tmp; while(ss >> tmp) va.push_back(tmp); for(int j = 0; j < va.size(); ++j) { for(int k = j + 1; k < va.size(); ++k) { int dis = abs(va[j] - va[k]) * vt[i]; if(dis < w[va[j]][va[k]]) w[va[j]][va[k]] = w[va[k]][va[j]] = dis; } } } vector<bool> vis(n, false); vector<int> d(100, INF); d[0] = 0; for(int i = 0; i < 100; ++i) { int x, m = INF; for(int y = 0; y < 100; ++y) { if(!vis[y] && d[y] < m) { m = d[y]; x = y; } } vis[x] = true; for(int y = 0; y < 100; ++y) { if(d[y] > d[x] + w[x][y] + 60) d[y] = d[x] + w[x][y] + 60; } } if(d[tar] == INF) cout << "IMPOSSIBLE\\n"; else { if(tar == 0) cout << "0\\n"; else cout << d[tar] - 60 << endl; } } return 0; } F - Page Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 map<int, int> m; void memNum(int n) { if(m.find(n) == m.end()) m[n] = m.size(); } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1, x, y; while(cin >> x >> y && !(x == 0 && y == 0)) { m.clear(); vector<vector<int>> g(110, vector<int>(110, INF)); for(int i = 0; i < 110; ++i) g[i][i] = 0; memNum(x); memNum(y); g[m[x]][m[y]] = 1; while(cin >> x >> y && !(x == 0 && y == 0)) { memNum(x); memNum(y); g[m[x]][m[y]] = 1; } int cnt = 0, sz = m.size(); for(int k = 0; k < sz; ++k) { for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { g[i][j] = min(g[i][j], g[i][k] + g[k][j]); } } } for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { if(g[i][j] != INF) cnt += g[i][j]; } } cout << "Case " << ca++ << ": average length between pages = "; cout << fixed << setprecision(3) << (double)cnt / (sz * (sz - 1)) << " clicks\\n"; } return 0; } G - Audiophobia 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int c, s, q, ca = 1; while(cin >> c >> s >> q && !(c == 0 && s == 0 && q == 0)) { vector<vector<int>> path(1005, vector<int>(1005, INF)); int c1, c2, d; for(int i = 0; i < s; ++i) { cin >> c1 >> c2 >> d; path[c1][c2] = path[c2][c1] = d; } for(int k = 1; k <= c; ++k) { for(int i = 1; i <= c; ++i) { for(int j = 1; j <= c; ++j) { path[i][j] = min(path[i][j], max(path[i][k], path[k][j])); } } } if(ca > 1) cout << endl; cout << "Case #" << ca++ << endl; for(int i = 0; i < q; ++i) { cin >> c1 >> c2; if(path[c1][c2] != INF) cout << path[c1][c2] << endl; else cout << "no path\\n"; } } return 0; } H - It&rsquo;s not a Bug, it&rsquo;s a Feature! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn (1<<20) + 10 #define maxm 110 int n, m, minTime; bool vis[maxn]; struct node { int time; int a1, a2, b1, b2; } a[maxm]; struct pqNode { int u, d; bool operator < (const pqNode &amp;r) const { return d > r.d; } }; bool dijkstra() { priority_queue<pqNode> pq; pq.push({(1 << n) - 1, 0}); while(!pq.empty()) { pqNode x = pq.top(); pq.pop(); if(x.u == 0) { minTime = x.d; return true; } if(vis[x.u]) continue; vis[x.u] = true; for(int i = 0; i < m; ++i) { if((x.u & a[i].a1) == a[i].a1 && (~x.u & a[i].a2) == a[i].a2) { int t = x.u | a[i].b1; t = t & ~a[i].b2; pq.push({t, x.d + a[i].time}); } } } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1; while(cin >> n >> m && !(n == 0 && m == 0)) { cout << "Product " << ca++ << endl; memset(vis, false, sizeof(vis)); for(int i = 0; i <= m; ++i) a[i].time = a[i].a1 = a[i].a2 = a[i].b1 = a[i].b2 = 0; for(int i = 0; i < m; ++i) { int t; string s1, s2; cin >> t >> s1 >> s2; for(int j = 0; j < n; ++j) { a[i].time = t; if(s1[n - 1 - j] == &#39;+&#39;) a[i].a1 = (a[i].a1 | (1 << j)); if(s1[n - 1 - j] == &#39;-&#39;) a[i].a2 = (a[i].a2 | (1 << j)); if(s2[n - 1 - j] == &#39;+&#39;) a[i].b1 = (a[i].b1 | (1 << j)); if(s2[n - 1 - j] == &#39;-&#39;) a[i].b2 = (a[i].b2 | (1 << j)); } } if(dijkstra()) cout << "Fastest sequence takes " << minTime << " seconds.\\n"; else cout << "Bugs cannot be fixed.\\n"; cout << endl; } return 0; } I - Airport Express 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn 505 struct edge { int u, v, dist; }; struct node { int d, u; bool operator < (const node &amp;r) const { return d > r.d; } }; vector<edge> ve; vector<int> g[maxn], path1[maxn], path2[maxn]; bool done[maxn]; int d[maxn], p[maxn], d1[maxn], d2[maxn]; int ca = 0, n, s, e, m, k; void dijkstra(int s, int *dist, vector<int> *paths) { priority_queue<node> pq; for(int i = 0; i < n; ++i) d[i] = INF; d[s] = 0; memset(done, 0, sizeof(done)); pq.push({0, s}); while(!pq.empty()) { node x = pq.top(); pq.pop(); if(done[x.u]) continue; done[x.u] = true; for(int i = 0; i < g[x.u].size(); ++i) { edge &amp;e = ve[g[x.u][i]]; if(d[e.v] > d[x.u] + e.dist) { d[e.v] = d[x.u] + e.dist; p[e.v] = g[x.u][i]; pq.push({d[e.v], e.v}); } } } for(int i = 0; i < n; ++i) { dist[i] = d[i]; paths[i].clear(); int t = i; paths[i].push_back(t); while(t != s) { paths[i].push_back(ve[p[t]].u); t = ve[p[t]].u; } reverse(paths[i].begin(), paths[i].end()); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> s >> e >> m) { for(int i = 0; i < n; ++i) g[i].clear(); ve.clear(); --s; --e; for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; ve.push_back({a, b, c}); g[a].push_back(ve.size()-1); ve.push_back({b, a, c}); g[b].push_back(ve.size()-1); } dijkstra(s, d1, path1); dijkstra(e, d2, path2); int ans = d1[e]; vector<int> pp = path1[e]; int midpoint = -1; cin >> k; for(int i = 0; i < k; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; for(int j = 0; j < 2; ++j) { if(d1[a] + d2[b] + c < ans) { ans = d1[a] + d2[b] + c; pp = path1[a]; for(int p = path2[b].size() - 1; p >= 0; --p) pp.push_back(path2[b][p]); midpoint = a; } swap(a, b); } } if(ca++ != 0) cout << endl; for(int i = 0; i < pp.size() - 1; ++i) cout << pp[i] + 1 << " "; cout << e + 1 << endl; if(midpoint == -1) cout << "Ticket Not Used\\n"; else cout << midpoint + 1 << endl; cout << ans << endl; } return 0; } J - Walk Through the Forest 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 vector<pair<int, int>> link[1001]; vector<int> rebuild[1001]; int distant[1001]; int dp[1001]; bool vis[1001]; int n, m; struct node { int dis, index; bool operator < (const node &amp;r) const { return dis > r.dis; } }; int dfs(int now) { if(now == 1) return 1; if(dp[now] == -1) { dp[now] = 0; for(auto i : rebuild[now]) dp[now] += dfs(i); } return dp[now]; } void dijkstra() { priority_queue<node> pq; pq.push({0, 1}); int cur; distant[1] = 0; while(!pq.empty()) { cur = pq.top().index; pq.pop(); if(vis[cur]) continue; vis[cur] = 1; for(auto i : link[cur]) { int next = i.first; int dis = i.second; if(distant[next] > distant[cur] + dis) { distant[next] = distant[cur] + dis; pq.push({distant[next], next}); } } } } void build() { memset(dp, -1, sizeof(dp)); int next, dis; for(int i = 0; i < n; ++i) { rebuild[i].clear(); for(auto j : link[i]) if(distant[i] > distant[j.first]) rebuild[i].emplace_back(j.first); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> m && n) { memset(link, 0, sizeof(link)); memset(vis, 0, sizeof(vis)); for(int i = 0; i < n; ++i) distant[i] = INF; while(m--) { int a, b, c; cin >> a >> b >> c; link[--a].push_back({--b, c}); link[b].push_back({a, c}); } dijkstra(); build(); cout << dfs(0) << &#39;\\n&#39;; } return 0; } '><meta property='og:url' content='https://blog.smallten.me/p/star_coder-07/'><meta property='og:site_name' content='小十的部落格'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='UVA'><meta property='article:published_time' content='2021-08-18T16:02:47+08:00'><meta property='article:modified_time' content='2021-08-18T16:02:47+08:00'><meta name=twitter:title content="StarCoder2021暑訓：Week06"><meta name=twitter:description content='主題 最短路徑 最短路徑模板 Dijkstra’s 不能有負邊 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 int vn; // vertex num struct Edge { int w, idx; bool operator < (const Edge &amp;r) const { return w > r.w; } }; vector<Edge> adj[maxv]; void dijkstra(int s) { vector<bool> vis(vn, false); vector<int> dist(vn, INF); dist[s] = 0; priority_queue<Edge> pq; pq.emplace(0, s); while(!pq.empty()) { int u = pq.top().idx; pq.pop(); if(vis[u]) continue; vis[u] = true; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { dist[v.idx] = dist[u] + v.w; pq.emplace(dist[v.idx], v.idx); } } } } Bellman-Ford 可以檢查是否有環 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 int vn; // vertex num struct Edge { int idx, w; }; vector<Edge> adj[maxv]; bool bellmanford(int s) { //return true if negative cycle exists; int cnt = 0; bool update = false; vector<int> dist(vn, INF); dist[s] = 0; do { if(++cnt == vn) return true; update = false; for(int u = 0; u < vn; ++u) { if(dist[u] == INF) continue; for(auto v : adj[u]) { if(dist[v.idx] > dist[u] + v.w) { update = true; dist[v.idx] = dist[u] + v.w; } } } } while(update); return false; } Floyd-Warshall 1 2 3 4 5 int dist[MAX_V][MAX_V]; for(int k = 0; k < vn; ++k) for(int i = 0; i < vn; ++i) for(int j = 0; j < vn; ++j) dist[i][j] = min(dist[i][j], dist[i][k] + dist[k][j]); 題目 Virtual Judge 題目列表與提示 題目 題目需求 難度 UVa 929 給一個二維迷宮，求左上走到右下的最少成本（最短路徑）。 單源模板題 UVa 10986 給一個無向帶權圖，求指定兩點間的最短路徑長。 單源模板題 UVa 10000 給一個有向無環圖，求指定兩點間的最長路徑。 多種作法 UVa 558 給定一個有向帶權圖（黑洞通道為邊），問是否存在負環（可回到無限遠的過去）。 BF UVa 10801 給定電梯系統與移動時間，若轉換電梯需 60 秒，問去某樓的最短時間。 單源小變化 UVa 821 給一個無向無權圖，求所有兩點間最短路徑長的平均值。 FW 模板題 UVa 10048 給一個無向帶權圖，求指定兩點間路徑上最大邊權的最小值。 FW 變化 UVa 658 給一堆修補程式的安裝前後狀態，問最少要安裝多少次修補程式可以修好所有 bug。 變化題 UVa 11374 給經濟線和商業線兩套捷運路線圖的行駛時間，在商業線只能搭一段的限制下，求指定兩點間的最快路線。 變化題 UVa 10917 題目不長，自己讀讀看。 變化題 參考作法 A - Number Maze 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using tiii = tuple<int, int, int>; int d[4][2] = {{0, 1}, {1, 0}, {0, -1}, {-1, 0}}; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { int n, m; cin >> n >> m; vector<vector<int>> g(n, vector<int>(m, 0)); vector<vector<int>> val(n, vector<int>(m, -1)); vector<vector<bool>> vis(n, vector<bool>(m, false)); priority_queue<tiii, vector<tiii>, greater<tiii>> pq; for(int i = 0; i < n; ++i) for(int j = 0; j < m; ++j) cin >> g[i][j]; val[0][0] = g[0][0]; pq.push(make_tuple(g[0][0], 0, 0)); while(!pq.empty()) { int v, x, y; tie(v, x, y) = pq.top(); pq.pop(); vis[x][y] = true; for(int i = 0; i < 4; ++i) { int nx = x + d[i][0], ny = y + d[i][1]; if(nx >= 0 && nx < n && ny >= 0 && ny < m && !vis[nx][ny]) { int tmp = v + g[nx][ny]; if(val[nx][ny] == -1 || val[nx][ny] > tmp) { val[nx][ny] = tmp; pq.push(make_tuple(tmp, nx, ny)); } } } } cout << val[n - 1][m - 1] << endl; } return 0; } B - Sending email 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 using pii = pair<int, int>; using plli = pair<long long, int>; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; for(int ca = 1; ca <= T; ++ca) { cout << "Case #" << ca << ": "; int n, m, s, t; cin >> n >> m >> s >> t; vector<pii> g[n]; vector<long long> val(n, INF); vector<bool> vis(n, false); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; g[a].push_back({b, c}); g[b].push_back({a, c}); } priority_queue<plli, vector<plli>, greater<plli>> pq; val[s] = 0; pq.push({0, s}); while(!pq.empty()) { int v = pq.top().first, x = pq.top().second; pq.pop(); if(val[x] < v) continue; for(auto it : g[x]) { if(val[it.first] > val[x] + it.second) { val[it.first] = val[x] + it.second; pq.push({val[it.first], it.first}); } } } if(val[t] == INF) cout << "unreachable\\n"; else cout << val[t] << endl; } return 0; } C - Longest Paths 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 struct edge { int u, v; }; int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, cnt = 0; while(cin >> n && n) { int s; cin >> s; int p, q; vector<edge> g; vector<int> val(n + 1, INF); while(cin >> p >> q && !(p == 0 && q == 0)) g.push_back({p, q}); val[s] = 0; for(int i = 0; i < n; ++i) { for(auto it : g) { if(val[it.v] > val[it.u] - 1 && val[it.u] != INF) val[it.v] = val[it.u] - 1; } } int en, ans = 0; for(int i = 1; i <= n; ++i) { if(val[i] < ans) { ans = val[i]; en = i; } } cout << "Case " << ++cnt << ": The longest path from " << s << " has length " << -1 * ans << ", finishing at " << en << ".\\n\\n"; } return 0; } D - Wormholes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int n, m; struct edge { int u, v, w; }; bool Bellman_Ford(vector<edge> &amp;ve, vector<int> val) { for(int i = 0; i < n; ++i) { bool flag = false; for(int j = 0; j < m; ++j) { if(val[ve[j].v] > val[ve[j].u] + ve[j].w && val[ve[j].u] != INF) { val[ve[j].v] = val[ve[j].u] + ve[j].w; flag = true; } } if(!flag) return true; if(i == n - 1 && flag) return false; } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int T; cin >> T; while(T--) { cin >> n >> m; vector<edge> ve; vector<int> val(n, INF); for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; ve.push_back({a, b, c}); } val[0] = 0; if(Bellman_Ford(ve, val)) cout << "not possible\\n"; else cout << "possible\\n"; } return 0; } E - Lift Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int n, tar; while(cin >> n >> tar) { vector<int> vt(n), va; vector<vector<int>> w(100, vector<int>(100, INF)); for(int i = 0; i < n; ++i) cin >> vt[i]; cin.ignore(100, &#39;\\n&#39;); for(int i = 0; i < n; ++i) { va.clear(); string s; getline(cin, s); stringstream ss(s); int tmp; while(ss >> tmp) va.push_back(tmp); for(int j = 0; j < va.size(); ++j) { for(int k = j + 1; k < va.size(); ++k) { int dis = abs(va[j] - va[k]) * vt[i]; if(dis < w[va[j]][va[k]]) w[va[j]][va[k]] = w[va[k]][va[j]] = dis; } } } vector<bool> vis(n, false); vector<int> d(100, INF); d[0] = 0; for(int i = 0; i < 100; ++i) { int x, m = INF; for(int y = 0; y < 100; ++y) { if(!vis[y] && d[y] < m) { m = d[y]; x = y; } } vis[x] = true; for(int y = 0; y < 100; ++y) { if(d[y] > d[x] + w[x][y] + 60) d[y] = d[x] + w[x][y] + 60; } } if(d[tar] == INF) cout << "IMPOSSIBLE\\n"; else { if(tar == 0) cout << "0\\n"; else cout << d[tar] - 60 << endl; } } return 0; } F - Page Hopping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 map<int, int> m; void memNum(int n) { if(m.find(n) == m.end()) m[n] = m.size(); } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1, x, y; while(cin >> x >> y && !(x == 0 && y == 0)) { m.clear(); vector<vector<int>> g(110, vector<int>(110, INF)); for(int i = 0; i < 110; ++i) g[i][i] = 0; memNum(x); memNum(y); g[m[x]][m[y]] = 1; while(cin >> x >> y && !(x == 0 && y == 0)) { memNum(x); memNum(y); g[m[x]][m[y]] = 1; } int cnt = 0, sz = m.size(); for(int k = 0; k < sz; ++k) { for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { g[i][j] = min(g[i][j], g[i][k] + g[k][j]); } } } for(int i = 0; i < sz; ++i) { for(int j = 0; j < sz; ++j) { if(g[i][j] != INF) cnt += g[i][j]; } } cout << "Case " << ca++ << ": average length between pages = "; cout << fixed << setprecision(3) << (double)cnt / (sz * (sz - 1)) << " clicks\\n"; } return 0; } G - Audiophobia 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int c, s, q, ca = 1; while(cin >> c >> s >> q && !(c == 0 && s == 0 && q == 0)) { vector<vector<int>> path(1005, vector<int>(1005, INF)); int c1, c2, d; for(int i = 0; i < s; ++i) { cin >> c1 >> c2 >> d; path[c1][c2] = path[c2][c1] = d; } for(int k = 1; k <= c; ++k) { for(int i = 1; i <= c; ++i) { for(int j = 1; j <= c; ++j) { path[i][j] = min(path[i][j], max(path[i][k], path[k][j])); } } } if(ca > 1) cout << endl; cout << "Case #" << ca++ << endl; for(int i = 0; i < q; ++i) { cin >> c1 >> c2; if(path[c1][c2] != INF) cout << path[c1][c2] << endl; else cout << "no path\\n"; } } return 0; } H - It&rsquo;s not a Bug, it&rsquo;s a Feature! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn (1<<20) + 10 #define maxm 110 int n, m, minTime; bool vis[maxn]; struct node { int time; int a1, a2, b1, b2; } a[maxm]; struct pqNode { int u, d; bool operator < (const pqNode &amp;r) const { return d > r.d; } }; bool dijkstra() { priority_queue<pqNode> pq; pq.push({(1 << n) - 1, 0}); while(!pq.empty()) { pqNode x = pq.top(); pq.pop(); if(x.u == 0) { minTime = x.d; return true; } if(vis[x.u]) continue; vis[x.u] = true; for(int i = 0; i < m; ++i) { if((x.u & a[i].a1) == a[i].a1 && (~x.u & a[i].a2) == a[i].a2) { int t = x.u | a[i].b1; t = t & ~a[i].b2; pq.push({t, x.d + a[i].time}); } } } return false; } int main() { #ifndef ONLINE_JUDGE freopen("output.txt", "w", stdout); freopen("input.txt", "r", stdin); #endif USE_CPPIO(); int ca = 1; while(cin >> n >> m && !(n == 0 && m == 0)) { cout << "Product " << ca++ << endl; memset(vis, false, sizeof(vis)); for(int i = 0; i <= m; ++i) a[i].time = a[i].a1 = a[i].a2 = a[i].b1 = a[i].b2 = 0; for(int i = 0; i < m; ++i) { int t; string s1, s2; cin >> t >> s1 >> s2; for(int j = 0; j < n; ++j) { a[i].time = t; if(s1[n - 1 - j] == &#39;+&#39;) a[i].a1 = (a[i].a1 | (1 << j)); if(s1[n - 1 - j] == &#39;-&#39;) a[i].a2 = (a[i].a2 | (1 << j)); if(s2[n - 1 - j] == &#39;+&#39;) a[i].b1 = (a[i].b1 | (1 << j)); if(s2[n - 1 - j] == &#39;-&#39;) a[i].b2 = (a[i].b2 | (1 << j)); } } if(dijkstra()) cout << "Fastest sequence takes " << minTime << " seconds.\\n"; else cout << "Bugs cannot be fixed.\\n"; cout << endl; } return 0; } I - Airport Express 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 #define maxn 505 struct edge { int u, v, dist; }; struct node { int d, u; bool operator < (const node &amp;r) const { return d > r.d; } }; vector<edge> ve; vector<int> g[maxn], path1[maxn], path2[maxn]; bool done[maxn]; int d[maxn], p[maxn], d1[maxn], d2[maxn]; int ca = 0, n, s, e, m, k; void dijkstra(int s, int *dist, vector<int> *paths) { priority_queue<node> pq; for(int i = 0; i < n; ++i) d[i] = INF; d[s] = 0; memset(done, 0, sizeof(done)); pq.push({0, s}); while(!pq.empty()) { node x = pq.top(); pq.pop(); if(done[x.u]) continue; done[x.u] = true; for(int i = 0; i < g[x.u].size(); ++i) { edge &amp;e = ve[g[x.u][i]]; if(d[e.v] > d[x.u] + e.dist) { d[e.v] = d[x.u] + e.dist; p[e.v] = g[x.u][i]; pq.push({d[e.v], e.v}); } } } for(int i = 0; i < n; ++i) { dist[i] = d[i]; paths[i].clear(); int t = i; paths[i].push_back(t); while(t != s) { paths[i].push_back(ve[p[t]].u); t = ve[p[t]].u; } reverse(paths[i].begin(), paths[i].end()); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> s >> e >> m) { for(int i = 0; i < n; ++i) g[i].clear(); ve.clear(); --s; --e; for(int i = 0; i < m; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; ve.push_back({a, b, c}); g[a].push_back(ve.size()-1); ve.push_back({b, a, c}); g[b].push_back(ve.size()-1); } dijkstra(s, d1, path1); dijkstra(e, d2, path2); int ans = d1[e]; vector<int> pp = path1[e]; int midpoint = -1; cin >> k; for(int i = 0; i < k; ++i) { int a, b, c; cin >> a >> b >> c; --a; --b; for(int j = 0; j < 2; ++j) { if(d1[a] + d2[b] + c < ans) { ans = d1[a] + d2[b] + c; pp = path1[a]; for(int p = path2[b].size() - 1; p >= 0; --p) pp.push_back(path2[b][p]); midpoint = a; } swap(a, b); } } if(ca++ != 0) cout << endl; for(int i = 0; i < pp.size() - 1; ++i) cout << pp[i] + 1 << " "; cout << e + 1 << endl; if(midpoint == -1) cout << "Ticket Not Used\\n"; else cout << midpoint + 1 << endl; cout << ans << endl; } return 0; } J - Walk Through the Forest 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #include <bits/stdc++.h> using namespace std; #define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0) #define INF 0x3f3f3f3f #define NINF 0xc0c0c0c0 vector<pair<int, int>> link[1001]; vector<int> rebuild[1001]; int distant[1001]; int dp[1001]; bool vis[1001]; int n, m; struct node { int dis, index; bool operator < (const node &amp;r) const { return dis > r.dis; } }; int dfs(int now) { if(now == 1) return 1; if(dp[now] == -1) { dp[now] = 0; for(auto i : rebuild[now]) dp[now] += dfs(i); } return dp[now]; } void dijkstra() { priority_queue<node> pq; pq.push({0, 1}); int cur; distant[1] = 0; while(!pq.empty()) { cur = pq.top().index; pq.pop(); if(vis[cur]) continue; vis[cur] = 1; for(auto i : link[cur]) { int next = i.first; int dis = i.second; if(distant[next] > distant[cur] + dis) { distant[next] = distant[cur] + dis; pq.push({distant[next], next}); } } } } void build() { memset(dp, -1, sizeof(dp)); int next, dis; for(int i = 0; i < n; ++i) { rebuild[i].clear(); for(auto j : link[i]) if(distant[i] > distant[j.first]) rebuild[i].emplace_back(j.first); } } int main() { #ifndef ONLINE_JUDGE freopen("input.txt", "r", stdin); freopen("output.txt", "w", stdout); #endif USE_CPPIO(); while(cin >> n >> m && n) { memset(link, 0, sizeof(link)); memset(vis, 0, sizeof(vis)); for(int i = 0; i < n; ++i) distant[i] = INF; while(m--) { int a, b, c; cin >> a >> b >> c; link[--a].push_back({--b, c}); link[b].push_back({a, c}); } dijkstra(); build(); cout << dfs(0) << &#39;\\n&#39;; } return 0; } '><link rel="shortcut icon" href=/image/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-9L51K4B2CR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9L51K4B2CR")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu11372239997511506855.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>小十的部落格</a></h1><h2 class=site-description>教學、資訊分享、生活記趣</h2></div></header><ol class=menu-social><li><a href=https://github.com/Adam7066 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#主題>主題</a><ul><li><a href=#最短路徑模板>最短路徑模板</a><ul><li><a href=#dijkstras>Dijkstra’s</a></li><li><a href=#bellman-ford>Bellman-Ford</a></li><li><a href=#floyd-warshall>Floyd-Warshall</a></li></ul></li></ul></li><li><a href=#題目>題目</a></li><li><a href=#參考作法>參考作法</a><ul><li><a href=#a---number-maze>A - Number Maze</a></li><li><a href=#b---sending-email>B - Sending email</a></li><li><a href=#c---longest-paths>C - Longest Paths</a></li><li><a href=#d---wormholes>D - Wormholes</a></li><li><a href=#e---lift-hopping>E - Lift Hopping</a></li><li><a href=#f---page-hopping>F - Page Hopping</a></li><li><a href=#g---audiophobia>G - Audiophobia</a></li><li><a href=#h---its-not-a-bug-its-a-feature>H - It&rsquo;s not a Bug, it&rsquo;s a Feature!</a></li><li><a href=#i---airport-express>I - Airport Express</a></li><li><a href=#j---walk-through-the-forest>J - Walk Through the Forest</a></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/starcoder/>StarCoder</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/star_coder-07/>StarCoder2021暑訓：Week06</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 18, 2021</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>15 minute read</time></div></footer></div></header><section class=article-content><h1 id=主題><a href=#%e4%b8%bb%e9%a1%8c class=header-anchor></a>主題</h1><ul><li>最短路徑</li></ul><h2 id=最短路徑模板><a href=#%e6%9c%80%e7%9f%ad%e8%b7%af%e5%be%91%e6%a8%a1%e6%9d%bf class=header-anchor></a>最短路徑模板</h2><h3 id=dijkstras><a href=#dijkstras class=header-anchor></a>Dijkstra’s</h3><ul><li>不能有負邊</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>vn</span><span class=p>;</span> <span class=c1>// vertex num
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>struct</span> <span class=nc>Edge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>w</span><span class=p>,</span> <span class=n>idx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span> <span class=o>&lt;</span> <span class=p>(</span><span class=k>const</span> <span class=n>Edge</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>.</span><span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>Edge</span><span class=o>&gt;</span> <span class=n>adj</span><span class=p>[</span><span class=n>maxv</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>dijkstra</span><span class=p>(</span><span class=kt>int</span> <span class=n>s</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>vis</span><span class=p>(</span><span class=n>vn</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>dist</span><span class=p>(</span><span class=n>vn</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>dist</span><span class=p>[</span><span class=n>s</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>Edge</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pq</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>().</span><span class=n>idx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>vis</span><span class=p>[</span><span class=n>u</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vis</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>v</span> <span class=p>:</span> <span class=n>adj</span><span class=p>[</span><span class=n>u</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>v</span><span class=p>.</span><span class=n>w</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>dist</span><span class=p>[</span><span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>v</span><span class=p>.</span><span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>pq</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>],</span> <span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=bellman-ford><a href=#bellman-ford class=header-anchor></a>Bellman-Ford</h3><ul><li>可以檢查是否有環</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>vn</span><span class=p>;</span> <span class=c1>// vertex num
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>struct</span> <span class=nc>Edge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>idx</span><span class=p>,</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>Edge</span><span class=o>&gt;</span> <span class=n>adj</span><span class=p>[</span><span class=n>maxv</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>bellmanford</span><span class=p>(</span><span class=kt>int</span> <span class=n>s</span><span class=p>)</span> <span class=p>{</span> <span class=c1>//return true if negative cycle exists;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=n>update</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>dist</span><span class=p>(</span><span class=n>vn</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>dist</span><span class=p>[</span><span class=n>s</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>++</span><span class=n>cnt</span> <span class=o>==</span> <span class=n>vn</span><span class=p>)</span> <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>update</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>vn</span><span class=p>;</span> <span class=o>++</span><span class=n>u</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>==</span> <span class=n>INF</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>v</span> <span class=p>:</span> <span class=n>adj</span><span class=p>[</span><span class=n>u</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>v</span><span class=p>.</span><span class=n>w</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>update</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>dist</span><span class=p>[</span><span class=n>v</span><span class=p>.</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>v</span><span class=p>.</span><span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span><span class=p>(</span><span class=n>update</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=floyd-warshall><a href=#floyd-warshall class=header-anchor></a>Floyd-Warshall</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>dist</span><span class=p>[</span><span class=n>MAX_V</span><span class=p>][</span><span class=n>MAX_V</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>vn</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>vn</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>vn</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=n>dist</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=題目><a href=#%e9%a1%8c%e7%9b%ae class=header-anchor></a>題目</h1><ul><li><a class=link href=https://vjudge.net/contest/453684 target=_blank rel=noopener>Virtual Judge</a></li><li>題目列表與提示<div class=table-wrapper><table><thead><tr><th style=text-align:left>題目</th><th style=text-align:left>題目需求</th><th style=text-align:left>難度</th></tr></thead><tbody><tr><td style=text-align:left>UVa 929</td><td style=text-align:left>給一個二維迷宮，求左上走到右下的最少成本（最短路徑）。</td><td style=text-align:left>單源模板題</td></tr><tr><td style=text-align:left>UVa 10986</td><td style=text-align:left>給一個無向帶權圖，求指定兩點間的最短路徑長。</td><td style=text-align:left>單源模板題</td></tr><tr><td style=text-align:left>UVa 10000</td><td style=text-align:left>給一個有向無環圖，求指定兩點間的最長路徑。</td><td style=text-align:left>多種作法</td></tr><tr><td style=text-align:left>UVa 558</td><td style=text-align:left>給定一個有向帶權圖（黑洞通道為邊），問是否存在負環（可回到無限遠的過去）。</td><td style=text-align:left>BF</td></tr><tr><td style=text-align:left>UVa 10801</td><td style=text-align:left>給定電梯系統與移動時間，若轉換電梯需 60 秒，問去某樓的最短時間。</td><td style=text-align:left>單源小變化</td></tr><tr><td style=text-align:left>UVa 821</td><td style=text-align:left>給一個無向無權圖，求所有兩點間最短路徑長的平均值。</td><td style=text-align:left>FW 模板題</td></tr><tr><td style=text-align:left>UVa 10048</td><td style=text-align:left>給一個無向帶權圖，求指定兩點間路徑上最大邊權的最小值。</td><td style=text-align:left>FW 變化</td></tr><tr><td style=text-align:left>UVa 658</td><td style=text-align:left>給一堆修補程式的安裝前後狀態，問最少要安裝多少次修補程式可以修好所有 bug。</td><td style=text-align:left>變化題</td></tr><tr><td style=text-align:left>UVa 11374</td><td style=text-align:left>給經濟線和商業線兩套捷運路線圖的行駛時間，在商業線只能搭一段的限制下，求指定兩點間的最快路線。</td><td style=text-align:left>變化題</td></tr><tr><td style=text-align:left>UVa 10917</td><td style=text-align:left>題目不長，自己讀讀看。</td><td style=text-align:left>變化題</td></tr></tbody></table></div></li></ul><h1 id=參考作法><a href=#%e5%8f%83%e8%80%83%e4%bd%9c%e6%b3%95 class=header-anchor></a>參考作法</h1><h2 id=a---number-maze><a href=#a---number-maze class=header-anchor></a>A - Number Maze</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=n>tiii</span> <span class=o>=</span> <span class=n>tuple</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>d</span><span class=p>[</span><span class=mi>4</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>}};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>T</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>g</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>val</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>vis</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>tiii</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>tiii</span><span class=o>&gt;</span><span class=p>,</span> <span class=n>greater</span><span class=o>&lt;</span><span class=n>tiii</span><span class=o>&gt;&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>make_tuple</span><span class=p>(</span><span class=n>g</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>v</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>tie</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>vis</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>nx</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>d</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>ny</span> <span class=o>=</span> <span class=n>y</span> <span class=o>+</span> <span class=n>d</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>nx</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>nx</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>ny</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>ny</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>vis</span><span class=p>[</span><span class=n>nx</span><span class=p>][</span><span class=n>ny</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>v</span> <span class=o>+</span> <span class=n>g</span><span class=p>[</span><span class=n>nx</span><span class=p>][</span><span class=n>ny</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>nx</span><span class=p>][</span><span class=n>ny</span><span class=p>]</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span> <span class=o>||</span> <span class=n>val</span><span class=p>[</span><span class=n>nx</span><span class=p>][</span><span class=n>ny</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>tmp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>val</span><span class=p>[</span><span class=n>nx</span><span class=p>][</span><span class=n>ny</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>make_tuple</span><span class=p>(</span><span class=n>tmp</span><span class=p>,</span> <span class=n>nx</span><span class=p>,</span> <span class=n>ny</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>val</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=b---sending-email><a href=#b---sending-email class=header-anchor></a>B - Sending email</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=n>pii</span> <span class=o>=</span> <span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>plli</span> <span class=o>=</span> <span class=n>pair</span><span class=o>&lt;</span><span class=kt>long</span> <span class=kt>long</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>ca</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>ca</span> <span class=o>&lt;=</span> <span class=n>T</span><span class=p>;</span> <span class=o>++</span><span class=n>ca</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Case #&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>ca</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;: &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span> <span class=o>&gt;&gt;</span> <span class=n>s</span> <span class=o>&gt;&gt;</span> <span class=n>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pii</span><span class=o>&gt;</span> <span class=n>g</span><span class=p>[</span><span class=n>n</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span> <span class=kt>long</span><span class=o>&gt;</span> <span class=n>val</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>vis</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>a</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>b</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=n>a</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>plli</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>plli</span><span class=o>&gt;</span><span class=p>,</span> <span class=n>greater</span><span class=o>&lt;</span><span class=n>plli</span><span class=o>&gt;&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span><span class=p>[</span><span class=n>s</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=n>s</span><span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>().</span><span class=n>first</span><span class=p>,</span> <span class=n>x</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>v</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>it</span> <span class=p>:</span> <span class=n>g</span><span class=p>[</span><span class=n>x</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>first</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>val</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>+</span> <span class=n>it</span><span class=p>.</span><span class=n>second</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>first</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>+</span> <span class=n>it</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>first</span><span class=p>],</span> <span class=n>it</span><span class=p>.</span><span class=n>first</span><span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>==</span> <span class=n>INF</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;unreachable</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>val</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=c---longest-paths><a href=#c---longest-paths class=header-anchor></a>C - Longest Paths</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>struct</span> <span class=nc>edge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>edge</span><span class=o>&gt;</span> <span class=n>g</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>val</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>p</span> <span class=o>&gt;&gt;</span> <span class=n>q</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>p</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span><span class=p>[</span><span class=n>s</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>it</span> <span class=p>:</span> <span class=n>g</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>v</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>[</span><span class=n>it</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>en</span><span class=p>,</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>ans</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ans</span> <span class=o>=</span> <span class=n>val</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>en</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Case &#34;</span> <span class=o>&lt;&lt;</span> <span class=o>++</span><span class=n>cnt</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;: The longest path from &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>s</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; has length &#34;</span> <span class=o>&lt;&lt;</span> <span class=o>-</span><span class=mi>1</span> <span class=o>*</span> <span class=n>ans</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;, finishing at &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>en</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;.</span><span class=se>\n\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=d---wormholes><a href=#d---wormholes class=header-anchor></a>D - Wormholes</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>edge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>Bellman_Ford</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>edge</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>ve</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>bool</span> <span class=n>flag</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>v</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>val</span><span class=p>[</span><span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>w</span> <span class=o>&amp;&amp;</span> <span class=n>val</span><span class=p>[</span><span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>u</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INF</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>val</span><span class=p>[</span><span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>[</span><span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>ve</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>flag</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>flag</span><span class=p>)</span> <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>flag</span><span class=p>)</span> <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>T</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>edge</span><span class=o>&gt;</span> <span class=n>ve</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>val</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>ve</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>Bellman_Ford</span><span class=p>(</span><span class=n>ve</span><span class=p>,</span> <span class=n>val</span><span class=p>))</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;not possible</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;possible</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=e---lift-hopping><a href=#e---lift-hopping class=header-anchor></a>E - Lift Hopping</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>tar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>tar</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>vt</span><span class=p>(</span><span class=n>n</span><span class=p>),</span> <span class=n>va</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>w</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=n>INF</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>vt</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span><span class=p>.</span><span class=n>ignore</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=sc>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>va</span><span class=p>.</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>string</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>getline</span><span class=p>(</span><span class=n>cin</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>stringstream</span> <span class=n>ss</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span><span class=p>(</span><span class=n>ss</span> <span class=o>&gt;&gt;</span> <span class=n>tmp</span><span class=p>)</span> <span class=n>va</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>tmp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>va</span><span class=p>.</span><span class=n>size</span><span class=p>();</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>va</span><span class=p>.</span><span class=n>size</span><span class=p>();</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kt>int</span> <span class=n>dis</span> <span class=o>=</span> <span class=n>abs</span><span class=p>(</span><span class=n>va</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>va</span><span class=p>[</span><span class=n>k</span><span class=p>])</span> <span class=o>*</span> <span class=n>vt</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span><span class=p>(</span><span class=n>dis</span> <span class=o>&lt;</span> <span class=n>w</span><span class=p>[</span><span class=n>va</span><span class=p>[</span><span class=n>j</span><span class=p>]][</span><span class=n>va</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                        <span class=n>w</span><span class=p>[</span><span class=n>va</span><span class=p>[</span><span class=n>j</span><span class=p>]][</span><span class=n>va</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>w</span><span class=p>[</span><span class=n>va</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>va</span><span class=p>[</span><span class=n>j</span><span class=p>]]</span> <span class=o>=</span> <span class=n>dis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>vis</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>d</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=n>INF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=n>m</span> <span class=o>=</span> <span class=n>INF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=o>++</span><span class=n>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>vis</span><span class=p>[</span><span class=n>y</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>d</span><span class=p>[</span><span class=n>y</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>m</span> <span class=o>=</span> <span class=n>d</span><span class=p>[</span><span class=n>y</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>x</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>vis</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=o>++</span><span class=n>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>d</span><span class=p>[</span><span class=n>y</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>d</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>+</span> <span class=n>w</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>+</span> <span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>d</span><span class=p>[</span><span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>+</span> <span class=n>w</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>+</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>d</span><span class=p>[</span><span class=n>tar</span><span class=p>]</span> <span class=o>==</span> <span class=n>INF</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;IMPOSSIBLE</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>tar</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;0</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>d</span><span class=p>[</span><span class=n>tar</span><span class=p>]</span> <span class=o>-</span> <span class=mi>60</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=f---page-hopping><a href=#f---page-hopping class=header-anchor></a>F - Page Hopping</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>memNum</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>m</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>==</span> <span class=n>m</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>m</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ca</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>y</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>x</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=p>.</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>g</span><span class=p>(</span><span class=mi>110</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>110</span><span class=p>,</span> <span class=n>INF</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>110</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>memNum</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>memNum</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=p>[</span><span class=n>m</span><span class=p>[</span><span class=n>x</span><span class=p>]][</span><span class=n>m</span><span class=p>[</span><span class=n>y</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>y</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>x</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>memNum</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>memNum</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>m</span><span class=p>[</span><span class=n>x</span><span class=p>]][</span><span class=n>m</span><span class=p>[</span><span class=n>y</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>sz</span> <span class=o>=</span> <span class=n>m</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>sz</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>sz</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>sz</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=n>g</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>sz</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>sz</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INF</span><span class=p>)</span> <span class=n>cnt</span> <span class=o>+=</span> <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Case &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>ca</span><span class=o>++</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;: average length between pages = &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>fixed</span> <span class=o>&lt;&lt;</span> <span class=n>setprecision</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>cnt</span> <span class=o>/</span> <span class=p>(</span><span class=n>sz</span> <span class=o>*</span> <span class=p>(</span><span class=n>sz</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; clicks</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=g---audiophobia><a href=#g---audiophobia class=header-anchor></a>G - Audiophobia</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>c</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>ca</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>c</span> <span class=o>&gt;&gt;</span> <span class=n>s</span> <span class=o>&gt;&gt;</span> <span class=n>q</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>s</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>path</span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span> <span class=n>INF</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>c1</span><span class=p>,</span> <span class=n>c2</span><span class=p>,</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>s</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>c1</span> <span class=o>&gt;&gt;</span> <span class=n>c2</span> <span class=o>&gt;&gt;</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>path</span><span class=p>[</span><span class=n>c1</span><span class=p>][</span><span class=n>c2</span><span class=p>]</span> <span class=o>=</span> <span class=n>path</span><span class=p>[</span><span class=n>c2</span><span class=p>][</span><span class=n>c1</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>c</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>c</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>c</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>path</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>path</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>max</span><span class=p>(</span><span class=n>path</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>],</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>ca</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Case #&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>ca</span><span class=o>++</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>q</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>c1</span> <span class=o>&gt;&gt;</span> <span class=n>c2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>path</span><span class=p>[</span><span class=n>c1</span><span class=p>][</span><span class=n>c2</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INF</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>path</span><span class=p>[</span><span class=n>c1</span><span class=p>][</span><span class=n>c2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;no path</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=h---its-not-a-bug-its-a-feature><a href=#h---its-not-a-bug-its-a-feature class=header-anchor></a>H - It&rsquo;s not a Bug, it&rsquo;s a Feature!</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp>#define maxn (1&lt;&lt;20) + 10
</span></span></span><span class=line><span class=cl><span class=cp>#define maxm 110
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>minTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>vis</span><span class=p>[</span><span class=n>maxn</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>node</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>a1</span><span class=p>,</span> <span class=n>a2</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>a</span><span class=p>[</span><span class=n>maxm</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>pqNode</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span> <span class=o>&lt;</span> <span class=p>(</span><span class=k>const</span> <span class=n>pqNode</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>d</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>.</span><span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>dijkstra</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>pqNode</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>n</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>pqNode</span> <span class=n>x</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=n>u</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>minTime</span> <span class=o>=</span> <span class=n>x</span><span class=p>.</span><span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>vis</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vis</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>((</span><span class=n>x</span><span class=p>.</span><span class=n>u</span> <span class=o>&amp;</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a1</span><span class=p>)</span> <span class=o>==</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a1</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=o>~</span><span class=n>x</span><span class=p>.</span><span class=n>u</span> <span class=o>&amp;</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a2</span><span class=p>)</span> <span class=o>==</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>x</span><span class=p>.</span><span class=n>u</span> <span class=o>|</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>t</span> <span class=o>=</span> <span class=n>t</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>t</span><span class=p>,</span> <span class=n>x</span><span class=p>.</span><span class=n>d</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>time</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ca</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Product &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>ca</span><span class=o>++</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>memset</span><span class=p>(</span><span class=n>vis</span><span class=p>,</span> <span class=nb>false</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>vis</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>time</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a1</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a2</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b1</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>string</span> <span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>t</span> <span class=o>&gt;&gt;</span> <span class=n>s1</span> <span class=o>&gt;&gt;</span> <span class=n>s2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>time</span> <span class=o>=</span> <span class=n>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>s1</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;+&#39;</span><span class=p>)</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a1</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a1</span> <span class=o>|</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>s1</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a2</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>a2</span> <span class=o>|</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>s2</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;+&#39;</span><span class=p>)</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b1</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b1</span> <span class=o>|</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>s2</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b2</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>b2</span> <span class=o>|</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>dijkstra</span><span class=p>())</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Fastest sequence takes &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>minTime</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; seconds.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Bugs cannot be fixed.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=i---airport-express><a href=#i---airport-express class=header-anchor></a>I - Airport Express</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp>#define maxn 505
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>struct</span> <span class=nc>edge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>dist</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>node</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d</span><span class=p>,</span> <span class=n>u</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span> <span class=o>&lt;</span> <span class=p>(</span><span class=k>const</span> <span class=n>node</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>d</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>.</span><span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>edge</span><span class=o>&gt;</span> <span class=n>ve</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>g</span><span class=p>[</span><span class=n>maxn</span><span class=p>],</span> <span class=n>path1</span><span class=p>[</span><span class=n>maxn</span><span class=p>],</span> <span class=n>path2</span><span class=p>[</span><span class=n>maxn</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>done</span><span class=p>[</span><span class=n>maxn</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>d</span><span class=p>[</span><span class=n>maxn</span><span class=p>],</span> <span class=n>p</span><span class=p>[</span><span class=n>maxn</span><span class=p>],</span> <span class=n>d1</span><span class=p>[</span><span class=n>maxn</span><span class=p>],</span> <span class=n>d2</span><span class=p>[</span><span class=n>maxn</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ca</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>dijkstra</span><span class=p>(</span><span class=kt>int</span> <span class=n>s</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>dist</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>*</span><span class=n>paths</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>node</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>d</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>INF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span><span class=p>[</span><span class=n>s</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>memset</span><span class=p>(</span><span class=n>done</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>done</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=n>s</span><span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span> <span class=n>x</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>done</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>done</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>g</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>].</span><span class=n>size</span><span class=p>();</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>edge</span> <span class=o>&amp;</span><span class=n>e</span> <span class=o>=</span> <span class=n>ve</span><span class=p>[</span><span class=n>g</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>][</span><span class=n>i</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>d</span><span class=p>[</span><span class=n>e</span><span class=p>.</span><span class=n>v</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>d</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>e</span><span class=p>.</span><span class=n>dist</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>d</span><span class=p>[</span><span class=n>e</span><span class=p>.</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=n>e</span><span class=p>.</span><span class=n>dist</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span><span class=p>[</span><span class=n>e</span><span class=p>.</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=n>x</span><span class=p>.</span><span class=n>u</span><span class=p>][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>d</span><span class=p>[</span><span class=n>e</span><span class=p>.</span><span class=n>v</span><span class=p>],</span> <span class=n>e</span><span class=p>.</span><span class=n>v</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>t</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>t</span> <span class=o>!=</span> <span class=n>s</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>ve</span><span class=p>[</span><span class=n>p</span><span class=p>[</span><span class=n>t</span><span class=p>]].</span><span class=n>u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=o>=</span> <span class=n>ve</span><span class=p>[</span><span class=n>p</span><span class=p>[</span><span class=n>t</span><span class=p>]].</span><span class=n>u</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>reverse</span><span class=p>(</span><span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span> <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>end</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>s</span> <span class=o>&gt;&gt;</span> <span class=n>e</span> <span class=o>&gt;&gt;</span> <span class=n>m</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>ve</span><span class=p>.</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=o>--</span><span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>--</span><span class=n>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=o>--</span><span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=o>--</span><span class=n>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>ve</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>a</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>ve</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>ve</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>b</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>ve</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>dijkstra</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>d1</span><span class=p>,</span> <span class=n>path1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>dijkstra</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>d2</span><span class=p>,</span> <span class=n>path2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>d1</span><span class=p>[</span><span class=n>e</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>pp</span> <span class=o>=</span> <span class=n>path1</span><span class=p>[</span><span class=n>e</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>midpoint</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>k</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=o>--</span><span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=o>--</span><span class=n>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>d1</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=n>d2</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>ans</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>ans</span> <span class=o>=</span> <span class=n>d1</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=n>d2</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>pp</span> <span class=o>=</span> <span class=n>path1</span><span class=p>[</span><span class=n>a</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>path2</span><span class=p>[</span><span class=n>b</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>p</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>pp</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>path2</span><span class=p>[</span><span class=n>b</span><span class=p>][</span><span class=n>p</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                    <span class=n>midpoint</span> <span class=o>=</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>ca</span><span class=o>++</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>pp</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>pp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>e</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>midpoint</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Ticket Not Used</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>midpoint</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>ans</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=j---walk-through-the-forest><a href=#j---walk-through-the-forest class=header-anchor></a>J - Walk Through the Forest</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#define USE_CPPIO() ios_base::sync_with_stdio(0); cin.tie(0)
</span></span></span><span class=line><span class=cl><span class=cp>#define INF 0x3f3f3f3f
</span></span></span><span class=line><span class=cl><span class=cp>#define NINF 0xc0c0c0c0
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>link</span><span class=p>[</span><span class=mi>1001</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>rebuild</span><span class=p>[</span><span class=mi>1001</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>distant</span><span class=p>[</span><span class=mi>1001</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>dp</span><span class=p>[</span><span class=mi>1001</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>vis</span><span class=p>[</span><span class=mi>1001</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>node</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>dis</span><span class=p>,</span> <span class=n>index</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>operator</span> <span class=o>&lt;</span> <span class=p>(</span><span class=k>const</span> <span class=n>node</span> <span class=o>&amp;</span><span class=n>r</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>dis</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>.</span><span class=n>dis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>dfs</span><span class=p>(</span><span class=kt>int</span> <span class=n>now</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>now</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=n>now</span><span class=p>]</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>dp</span><span class=p>[</span><span class=n>now</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>i</span> <span class=p>:</span> <span class=n>rebuild</span><span class=p>[</span><span class=n>now</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>dp</span><span class=p>[</span><span class=n>now</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dfs</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dp</span><span class=p>[</span><span class=n>now</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>dijkstra</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>node</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>cur</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>distant</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cur</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>().</span><span class=n>index</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>vis</span><span class=p>[</span><span class=n>cur</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vis</span><span class=p>[</span><span class=n>cur</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>i</span> <span class=p>:</span> <span class=n>link</span><span class=p>[</span><span class=n>cur</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>next</span> <span class=o>=</span> <span class=n>i</span><span class=p>.</span><span class=n>first</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>dis</span> <span class=o>=</span> <span class=n>i</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>distant</span><span class=p>[</span><span class=n>next</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>distant</span><span class=p>[</span><span class=n>cur</span><span class=p>]</span> <span class=o>+</span> <span class=n>dis</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>distant</span><span class=p>[</span><span class=n>next</span><span class=p>]</span> <span class=o>=</span> <span class=n>distant</span><span class=p>[</span><span class=n>cur</span><span class=p>]</span> <span class=o>+</span> <span class=n>dis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>distant</span><span class=p>[</span><span class=n>next</span><span class=p>],</span> <span class=n>next</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>build</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>memset</span><span class=p>(</span><span class=n>dp</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>dp</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>next</span><span class=p>,</span> <span class=n>dis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>rebuild</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=k>auto</span> <span class=nl>j</span> <span class=p>:</span> <span class=n>link</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>distant</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>distant</span><span class=p>[</span><span class=n>j</span><span class=p>.</span><span class=n>first</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=n>rebuild</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>#ifndef ONLINE_JUDGE
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;input.txt&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>,</span> <span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>freopen</span><span class=p>(</span><span class=s>&#34;output.txt&#34;</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>,</span> <span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span><span class=line><span class=cl><span class=cp></span>    <span class=n>USE_CPPIO</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>memset</span><span class=p>(</span><span class=n>link</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>link</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>memset</span><span class=p>(</span><span class=n>vis</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>vis</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>distant</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>INF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>m</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>link</span><span class=p>[</span><span class=o>--</span><span class=n>a</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=o>--</span><span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=n>link</span><span class=p>[</span><span class=n>b</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=n>a</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>dijkstra</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>build</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>dfs</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39;\n&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/uva/>UVA</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/star_coder-06/><div class=article-details><h2 class=article-title>StarCoder2021暑訓：Week05</h2></div></a></article><article><a href=/p/star_coder-05/><div class=article-details><h2 class=article-title>StarCoder2021暑訓：Week04</h2></div></a></article><article><a href=/p/star_coder-04/><div class=article-details><h2 class=article-title>StarCoder2021暑訓：Week03</h2></div></a></article><article><a href=/p/star_coder-03/><div class=article-details><h2 class=article-title>StarCoder2021暑訓：Week02</h2></div></a></article><article><a href=/p/star_coder-02/><div class=article-details><h2 class=article-title>StarCoder2021暑訓：Week01</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 小十的部落格</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>